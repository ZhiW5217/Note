# 数据库的事务

- 事务的概念
- 事务的特征
- 事务的隔离级别
- 事务隔离级别产生的问题

## 事务的概念

- 什么是事务？？？

事务是用来保证 `业务操作` 的 `完整性` , 整个业务要么全部成功、要么全部失败
不允许部分成功或者部分失败。


银行的转账: 
	转账的步骤：
		1、输入账号、密码进行登录银行系统
		2、输入转账 账户 
		3、判断 转账 账户 是否存在，以及确认身份
		4、输入转账金额
		5、判断 当前账户 余额是否 足够
		6、将 转账 金额 从 自己的 银行卡 账户中 扣除
		---- 断电了？？？？
		
		7、将 转账 金额 打到 对方银行账户中
		8、完成转账 
		

## 事务的四大特性 ACID	
-  事务的目的: 是为了保证数据的一致性
	
原子性（Atomicity）
原子性是指事务是一个不可分割的工作单位，事务中的操作要么都发生，要么都不发生。

一致性（Consistency）
事务前后数据的完整性必须保持一致。

隔离性（Isolation）
事务的隔离性是多个用户并发访问数据库时，数据库为每一个用户开启的事务，不能被其他事务的操作数据所干扰，多个并发事务之间要相互隔离。

持久性（Durability）
持久性是指一个事务一旦被提交，它对数据库中数据的改变就是永久性的，接下来即使数据库发生故障也不应该对其有任何影响


## 事务的隔离级别  

- 读未提交  read-uncommitted
特点: 可以读取到 其他事务 未提交的 数据

- 读已提交  read-committed
特点: 只能读取到 其他事务 提交的 数据

- 可重复读  repeatable-read
特点: 可以读取到 其他事务 插入的数据 

- 序列化读  serializable
特点: 串行读取数据

PS : Oracle数据库默认的隔离级别是 读已提交 ， MySQL 隔离级别 可重复读


## 事务的隔离级别 产生的问题 

- 读未提交 :  最低的隔离级别、性能是最高的，但带来的问题也是最多的 (脏读、不可重复读、幻读)
- 读已提交 :  会带来 (不可重复读、幻读)， 解决了 脏读 的问题 
- 可重复读 :  是用来解决 不可重复读的问题， 会产生 幻读
- 序列化读 :  最高的隔离级别，性能是最低的，不会产生任何问题

### 脏读 

脏读: 读取到 事务未提交的数据 

### 不可重复读 

A事务在读取数据后， B事务对数据进行了修改，并提交，导致 A事务重新读取数据
发现内容内容不一致 

### 幻读

A事务 对表中 所有的数据、进行了修改、与此同时 B事务新增了一条记录并提交了事务
A提交事务、发现 表中有没有修改的数据 



	